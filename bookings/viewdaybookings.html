<html>

<head>
	<link rel="stylesheet" href="../css/bootstrap.min.css">
	<script src="../js/bootstrap.min.js"></script>
	<script src="../js/jquery-3.4.1.min.js"></script>
	<script src="../js/gijgo.min.js" type="text/javascript"></script>
	<link href="../css/gijgo.min.css" rel="stylesheet" type="text/css" />
</head>

<body>
	<script>
		let url_string = window.location.href;
		let url = new URL(url_string);

		let d = new Date;
		let currDate = "";
		let months = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];
		let monthnames = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
		let year = Number(url.searchParams.get("year"));
		let month = ' ';
		month = Number(url.searchParams.get("month"));
		let date = Number(url.searchParams.get("date"));

		month = (month < 10) ? "0" + month : month;
		date = (date < 10) ? "0" + date : date;
		currDate = year + " " + month + " " + date;

		function ajaxFunction(addDays) {
			date = Number(date);
			month = Number(month);
			date = date + addDays;
			if (date > months[month - 1]) {
				date = 1;
				month++;
				if (month == 13) {
					month = 1;
					year++;
				}
			}
			if (date == 0) {
				month--;
				if (month == 0) {
					month = 12;
					year--;
				}
				date = months[month - 1];
			}

			if (year % 4 == 0)
				months[1] = 29;
			else
				months[1] = 28;


			month = (month < 10) ? "0" + month : month;
			date = (date < 10) ? "0" + date : date;
			currDate = year + " " + month + " " + date;

			month = monthnames[Number(month)];
			copcurrDate = year + " " + month + " " + date;

			let request;

			try {
				request = new XMLHttpRequest();
			} catch (e) {
				try {
					request = new ActiveXObject("Msxml2.XMLHTTP");
				} catch (e) {
					try {
						request = new ActiveXObject("Microsoft.XMLHTTP");
					} catch (e) {
						return false;
					}
				}
			}

			request.onreadystatechange = function () {
				if (request.readyState == 4) {
					let display = document.getElementById('ajaxDiv');
					display.innerHTML = request.responseText;
				}
			}

			let queryString = "?date=" + currDate;
			request.open("GET", "filldays.php" + queryString, true);
			request.send(null);

			let div = document.getElementById("header");
			div.innerHTML = "<h2>Booking Schedule</h2><br><h3>" + copcurrDate + "</h3>";
		}

		function back() {
			document.location.href = 'viewmonthbookings.html';
		}
	</script>
	<div class="container-fluid">
		<br>
		<br>
		<div class="row">
			<div class="col-sm-4 text-center">
				<p class="btn btn-primary" onclick="ajaxFunction(-1)">Previous Day</p>
			</div>

			<div class="col-sm-4 text-center">
				<p class="btn btn-warning" onclick="back()">Back</p>
			</div>

			<div class="col-sm-4 text-center">
				<p class="btn btn-primary" onclick="ajaxFunction(1)">Next Day</p>
			</div>
		</div>
		<br>
		<div class="row">
			<div class="col-sm-3"></div>
			<div class="col-sm-6" align="center" id="header"></div>
		</div>
		<br>
		<div class="row">
			<div class="col-sm-3"></div>
			<div class="col-sm-6">
				<table class="table">
					<thead>
						<tr>
							<th>Time
							<th>Teacher
							<th>Class
					<tbody id="ajaxDiv">
						<script>
							ajaxFunction(0);
						</script>
				</table>
			</div>
		</div>
	</div>
</body>

</html>